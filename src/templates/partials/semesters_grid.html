{# Partial fragment: semesters grid for AJAX replacement #}
{% if semesters %}
<div class="grid gap-4 sm:grid-cols-2 md:grid-cols-3">
  {% for s in semesters %}
  <div class="p-4 rounded-lg bg-base-100 border border-base-300 hover:border-primary/70 transition card-glow flex flex-col gap-3 group">
    <div class="flex items-center justify-between">
      <div class="flex items-center gap-2">
        <h3 class="font-semibold"><a class="link link-hover" href="/semester/{{s.name}}?year={{s.year}}">{{s.name}}</a></h3>
        <span class="badge badge-outline">{{s.year}}</span>
      </div>
      <button class="btn btn-ghost btn-xs" onclick="this.closest('.p-4').querySelector('.manage-panel').classList.toggle('hidden');" title="Manage">⚙️</button>
    </div>
    <p class="text-xs opacity-70">View subjects & assignments</p>
    <div class="manage-panel hidden mt-1 animate-fade-in text-xs space-y-2">
      <form method="post" action="/semester/{{s.name}}/update" class="flex gap-1 items-end flex-wrap">
        <input type="hidden" name="year" value="{{s.year}}" />
        <label class="form-control w-28">
          <span class="label-text text-xs">Rename</span>
          <input name="new_name" placeholder="New name" class="input input-bordered input-xs" required />
        </label>
        <button class="btn btn-xs btn-primary mt-4" type="submit">Save</button>
      </form>
      <form method="post" action="/semester/{{s.name}}/delete" onsubmit="return confirm('Delete semester {{s.name}} {{s.year}} and ALL its data?');">
        <input type="hidden" name="year" value="{{s.year}}" />
        <button class="btn btn-xs btn-error btn-outline">Delete</button>
      </form>
    </div>
  </div>
  {% endfor %}
</div>
{% else %}
<div class="p-8 rounded-xl border-dashed border-2 text-center opacity-70">No semesters for {{selected_year}}. Add your first above.</div>
{% endif %}
